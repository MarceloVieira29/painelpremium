<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üìà Dashboard Financeiro Premium üìà</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { background: #f4f6f9; font-family: Arial, sans-serif; }
  header { background: linear-gradient(90deg,#1e3c72,#2a5298); color:#fff; text-align:center; padding:25px 10px; }
  .nav-tabs .nav-link.active { background:#1e3c72; color:#fff; border-color:#1e3c72; }
  .cards { display:flex; flex-wrap:wrap; gap:20px; justify-content:center; margin:20px 0; }
  .card { flex:1; min-width:220px; background:#fff; border-radius:12px; padding:20px; text-align:center; box-shadow:0 6px 12px rgba(0,0,0,0.1);}
  .card h2 { font-size:1.2rem; color:#555; margin:0; }
  .card p { font-size:1.6rem; font-weight:bold; margin:10px 0 0; }
  .chart-container { background:#fff; border-radius:12px; padding:20px; box-shadow:0 6px 12px rgba(0,0,0,0.1); margin:20px 0; }
  table { width:100%; border-collapse:collapse; margin-top:15px; }
  th, td { padding:10px; border-bottom:1px solid #ddd; text-align:left; }
  th { background:#1e3c72; color:#fff; }
  .delete-btn { color:#e74c3c; cursor:pointer; }
  .form-control, .form-select { border-radius:8px; }
  .btn { border-radius:8px; }
  @media(max-width:768px){ .cards { flex-direction:column; align-items:center; } }
</style>
</head>
<body>

<header>
  <h1>üí∞ Dashboard Financeiro Premium üìà</h1>
</header>

<div class="container mt-4">

  <!-- Abas -->
  <ul class="nav nav-tabs mb-4">
    <li class="nav-item"><button class="nav-link active" onclick="showTab('lancamentos')">Lan√ßamentos</button></li>
    <li class="nav-item"><button class="nav-link" onclick="showTab('relatorio')">Relat√≥rios</button></li>
    <li class="nav-item"><button class="nav-link" onclick="showTab('graficos')">Gr√°ficos</button></li>
  </ul>

  <!-- Cards Resumo -->
  <div class="cards">
    <div class="card"><h2>Receitas</h2><p id="totalReceitas">R$ 0,00</p></div>
    <div class="card"><h2>Despesas</h2><p id="totalDespesas">R$ 0,00</p></div>
    <div class="card"><h2>Saldo</h2><p id="saldoTotal">R$ 0,00</p></div>
  </div>

  <!-- Lan√ßamentos -->
  <div id="lancamentos" class="tab-content">
    <div class="card mb-3">
      <div class="card-body">
        <h5 class="card-title">Adicionar Receita/Despesa</h5>
        <div class="row g-3">
          <div class="col-md-3"><input type="date" id="data" class="form-control"></div>
          <div class="col-md-3">
            <select id="tipo" class="form-select">
              <option value="receita">Receita</option>
              <option value="despesa">Despesa</option>
            </select>
          </div>
          <div class="col-md-3">
            <select id="categoria" class="form-select">
              <optgroup label="Receitas">
                <option value="Sal√°rio">Sal√°rio</option>
                <option value="Investimento">Investimento</option>
              </optgroup>
              <optgroup label="Despesas">
                <option value="Aluguel">Aluguel</option>
                <option value="Pens√£o Aliment√≠cia">Pens√£o Aliment√≠cia</option>
                <option value="Internet">Internet</option>
                <option value="√Ågua">√Ågua</option>
                <option value="Luz">Luz</option>
                <option value="Empr√©stimos">Empr√©stimos</option>
                <option value="Cart√µes">Cart√µes</option>
                <option value="Lazer">Lazer</option>
                <option value="Eventos">Eventos</option>
                <option value="Viagens">Viagens</option>
              </optgroup>
            </select>
          </div>
          <div class="col-md-2"><input type="number" id="valor" step="0.01" class="form-control" placeholder="Valor R$"></div>
          <div class="col-md-1 d-flex align-items-end"><button class="btn btn-success w-100" onclick="adicionarLancamento()">‚ûï</button></div>
        </div>
      </div>
    </div>

    <div class="card chart-container">
      <h5>Lan√ßamentos Realizados</h5>
      <table class="table table-striped">
        <thead>
          <tr><th>Data</th><th>Tipo</th><th>Categoria</th><th>Valor</th><th>A√ß√£o</th></tr>
        </thead>
        <tbody id="tabela"></tbody>
      </table>
    </div>
  </div>

  <!-- Relat√≥rios -->
  <div id="relatorio" class="tab-content" style="display:none;">
    <div class="chart-container">
      <h5>Relat√≥rio por Per√≠odo</h5>
      <div class="row g-3 mb-3">
        <div class="col-md-3"><input type="date" id="inicio" class="form-control"></div>
        <div class="col-md-3"><input type="date" id="fim" class="form-control"></div>
        <div class="col-md-3">
          <select id="filtroTipo" class="form-select">
            <option value="">Todos</option>
            <option value="receita">Receita</option>
            <option value="despesa">Despesa</option>
          </select>
        </div>
        <div class="col-md-3">
          <select id="filtroCategoria" class="form-select">
            <option value="">Todas</option>
            <option value="Sal√°rio">Sal√°rio</option>
            <option value="Investimento">Investimento</option>
            <option value="Aluguel">Aluguel</option>
            <option value="Pens√£o Aliment√≠cia">Pens√£o Aliment√≠cia</option>
            <option value="Internet">Internet</option>
            <option value="√Ågua">√Ågua</option>
            <option value="Luz">Luz</option>
            <option value="Empr√©stimos">Empr√©stimos</option>
            <option value="Cart√µes">Cart√µes</option>
            <option value="Lazer">Lazer</option>
            <option value="Eventos">Eventos</option>
            <option value="Viagens">Viagens</option>
          </select>
        </div>
      </div>
      <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-primary me-2" onclick="gerarRelatorio()">Gerar</button>
        <button class="btn btn-outline-secondary" onclick="exportarCSV()">üì• Exportar CSV</button>
      </div>

      <canvas id="graficoRelatorio"></canvas>

      <div class="mt-4">
        <h5>Movimenta√ß√µes Filtradas</h5>
        <table class="table table-striped">
          <thead>
            <tr><th>Data</th><th>Tipo</th><th>Categoria</th><th>Valor (R$)</th></tr>
          </thead>
          <tbody id="tabelaRelatorio"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Gr√°ficos -->
  <div id="graficos" class="tab-content" style="display:none;">
    <div class="chart-container">
      <h5>Receitas x Despesas</h5>
      <canvas id="graficoPizza"></canvas>
    </div>
    <div class="chart-container">
      <h5>Evolu√ß√£o Mensal</h5>
      <canvas id="graficoLinha"></canvas>
    </div>
    <div class="chart-container">
      <h5>Valores por Categoria</h5>
      <canvas id="graficoBarra"></canvas>
    </div>
  </div>

</div>

<script>
let lancamentos = JSON.parse(localStorage.getItem('lancamentos')) || [];
let graficoRelatorio, graficoPizza, graficoLinha, graficoBarra;

function showTab(tabId){
  ['lancamentos','relatorio','graficos'].forEach(t=>{
    document.getElementById(t).style.display='none';
    document.querySelector(`.nav-link[onclick="showTab('${t}')"]`).classList.remove('active');
  });
  document.getElementById(tabId).style.display='block';
  document.querySelector(`.nav-link[onclick="showTab('${tabId}')"]`).classList.add('active');
}

function adicionarLancamento(){
  const data=document.getElementById('data').value;
  const tipo=document.getElementById('tipo').value;
  const categoria=document.getElementById('categoria').value;
  const valor=parseFloat(document.getElementById('valor').value);
  if(!data||!categoria||isNaN(valor)){ alert('Preencha todos os campos!'); return; }
  lancamentos.push({data,tipo,categoria,valor});
  localStorage.setItem('lancamentos',JSON.stringify(lancamentos));
  atualizarResumoTabelaGraficos();
  document.getElementById('data').value=''; document.getElementById('valor').value='';
}

function atualizarResumoTabelaGraficos(){
  const tbody=document.getElementById('tabela'); tbody.innerHTML='';
  let totalReceitas=0, totalDespesas=0;
  lancamentos.forEach((l,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${l.data}</td><td>${l.tipo}</td><td>${l.categoria}</td><td>R$ ${l.valor.toFixed(2)}</td><td><span class="delete-btn" onclick="excluirLancamento(${i})">‚ùå</span></td>`;
    tbody.appendChild(tr);
    if(l.tipo==='receita') totalReceitas+=l.valor; else totalDespesas+=l.valor;
  });
  document.getElementById('totalReceitas').textContent="R$ "+totalReceitas.toLocaleString('pt-BR');
  document.getElementById('totalDespesas').textContent="R$ "+totalDespesas.toLocaleString('pt-BR');
  document.getElementById('saldoTotal').textContent="R$ "+(totalReceitas-totalDespesas).toLocaleString('pt-BR');
  carregarGraficos();
}

function excluirLancamento(i){ lancamentos.splice(i,1); localStorage.setItem('lancamentos',JSON.stringify(lancamentos)); atualizarResumoTabelaGraficos(); }

function gerarRelatorio(){
  const inicio=document.getElementById('inicio').value;
  const fim=document.getElementById('fim').value;
  const tipoFiltro=document.getElementById('filtroTipo').value;
  const catFiltro=document.getElementById('filtroCategoria').value;
  if(!inicio||!fim){ alert('Selecione as datas!'); return; }

  let filtrados=lancamentos.filter(l=>l.data>=inicio && l.data<=fim);
  if(tipoFiltro) filtrados=filtrados.filter(l=>l.tipo===tipoFiltro);
  if(catFiltro) filtrados=filtrados.filter(l=>l.categoria===catFiltro);

  const tbody=document.getElementById('tabelaRelatorio');
  tbody.innerHTML='';
  filtrados.forEach(l=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${l.data}</td><td>${l.tipo}</td><td>${l.categoria}</td><td>${l.valor.toFixed(2)}</td>`;
    tbody.appendChild(tr);
  });

  const categorias={};
  filtrados.forEach(l=>{ if(!categorias[l.categoria]) categorias[l.categoria]=0; categorias[l.categoria]+=l.valor; });

  const ctx=document.getElementById('graficoRelatorio').getContext('2d');
  if(graficoRelatorio) graficoRelatorio.destroy();
  graficoRelatorio=new Chart(ctx,{
    type:'bar',
    data:{ labels:Object.keys(categorias), datasets:[{ label:'Valores', data:Object.values(categorias), backgroundColor:'#1e3c72', barThickness:30 }] },
    options:{ responsive:true, plugins:{ legend:{ display:false } } }
  });
}

function exportarCSV(){
  let csv="Data,Tipo,Categoria,Valor\n";
  lancamentos.forEach(l=>{ csv+=`${l.data},${l.tipo},${l.categoria},${l.valor}\n`; });
  const blob=new Blob([csv],{type:'text/csv'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url; a.download="lancamentos.csv"; a.click();
  URL.revokeObjectURL(url);
}

function carregarGraficos(){
  const totalReceitas=lancamentos.filter(l=>l.tipo==='receita').reduce((a,b)=>a+b.valor,0);
  const totalDespesas=lancamentos.filter(l=>l.tipo==='despesa').reduce((a,b)=>a+b.valor,0);
  const ctxPizza=document.getElementById('graficoPizza').getContext('2d');
  if(graficoPizza) graficoPizza.destroy();
  graficoPizza=new Chart(ctxPizza,{ type:'pie', data:{ labels:['Receitas','Despesas'], datasets:[{ data:[totalReceitas,totalDespesas], backgroundColor:['#28a745','#e74c3c'] }] } });

  const meses={};
  lancamentos.forEach(l=>{
    const m=l.data.slice(0,7);
    if(!meses[m]) meses[m]=0;
    meses[m]+=(l.tipo==='receita'?l.valor:-l.valor);
  });
  const ctxLinha=document.getElementById('graficoLinha').getContext('2d');
  if(graficoLinha) graficoLinha.destroy();
  graficoLinha=new Chart(ctxLinha,{ type:'line', data:{ labels:Object.keys(meses), datasets:[{ label:'Saldo Mensal', data:Object.values(meses), borderColor:'#1e3c72', tension:0.3 }] } });

  const cat={};
  lancamentos.forEach(l=>{ if(!cat[l.categoria]) cat[l.categoria]=0; cat[l.categoria]+=l.valor; });
  const ctxBar=document.getElementById('graficoBarra').getContext('2d');
  if(graficoBarra) graficoBarra.destroy();
  graficoBarra=new Chart(ctxBar,{ type:'bar', data:{ labels:Object.keys(cat), datasets:[{ label:'Valores', data:Object.values(cat), backgroundColor:'#1e3c72', barThickness:30 }] } });
}

atualizarResumoTabelaGraficos();
</script>

</body>
</html>
